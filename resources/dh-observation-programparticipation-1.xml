<?xml version="1.0" encoding="utf-8"?>
<StructureDefinition xmlns="http://hl7.org/fhir">
  <id value="dh-observation-programparticipation-1"/>
  <url
    value="http://ns.electronichealth.net.au/fhir/StructureDefinition/dh-observation-programparticipation-1"/>
  <version value="0.0.1"/>
  <name value="DHObservationHealthProgramParticipation"/>
  <title value="ADHA Health Program Participation Observation"/>
  <status value="draft"/>
  <experimental value="true"/>
  <publisher value="Australian Digital Health Agency"/>
  <contact>
    <telecom>
      <system value="email"/>
      <value value="help@digitalhealth.gov.au"/>
    </telecom>
  </contact>
  <description
    value="The purpose of this profile is to provide a representation of an individual's participation in a health program, e.g. disease screening or substance use therapy. Participation information may include information on an individual's eligibility for a program, suspension of participation in a program, or status of participation in a program."/>
  <copyright
    value="Copyright © 2022 Australian Digital Health Agency - All rights reserved. This content is licensed under a Creative Commons Attribution 4.0 International License. See https://creativecommons.org/licenses/by/4.0/."/>
  <fhirVersion value="4.0.1"/>
  <mapping>
    <identity value="CDA.observation-program_part"/>
    <uri value="http://hl7.org/v3/cda"/>
    <name value="Agency CDA Schema observation"/>
  </mapping>
  <kind value="resource"/>
  <abstract value="false"/>
  <type value="Observation"/>
  <baseDefinition
    value="http://ns.electronichealth.net.au/fhir/StructureDefinition/dh-observation-core-1"/>
  <derivation value="constraint"/>
  <differential>
    <element id="Observation">
      <path value="Observation"/>
      <short value="Health program participation observation"/>
      <definition
        value="A record of an individual's participation in a program, e.g. disease screening or substance use therapy. Participation information may include information on an individual's eligibility for a program, suspension of participation in a program, or status of participation in a program."/>
      <constraint>
        <key value="inv-dh-obs-01"/>
        <severity value="error"/>
        <human
          value="If there is no component element then either a value[x] or a data absent reason shall be present"/>
        <expression value="component.empty() implies (dataAbsentReason.exists() or value.exists())"/>
        <source
          value="http://ns.electronichealth.net.au/fhir/StructureDefinition/dh-observation-programparticipation-1"
        />
      </constraint>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation"/>
      </mapping>
    </element>
    <element id="Observation.status">
      <path value="Observation.status"/>
      <fixedCode value="final"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[status].observation"/>
      </mapping>
    </element>
    <element id="Observation.category">
      <path value="Observation.category"/>
      <patternCodeableConcept>
        <coding>
          <system value="http://terminology.hl7.au.org/CodeSystem/observation-category"/>
          <code value="program"/>
        </coding>
      </patternCodeableConcept>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[category].observation"/>
      </mapping>
    </element>
    <element id="Observation.code">
      <path value="Observation.code"/>
      <definition
        value="Describes the nature of the observation including specifying the type of program for which participation information for an invididual is observed, e.g. national breast cancer screening, or a substance use therapy program such as a twelve step alcohol program."/>
      <binding>
        <strength value="preferred"/>
        <valueSet value="https://healthterminologies.gov.au/fhir/ValueSet/health-programs-1"/>
      </binding>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.code"/>
      </mapping>
    </element>
    <element id="Observation.effective[x]">
      <path value="Observation.effective[x]"/>
      <short
        value="Date, and optionally time, this program participation information is asserted as 'true'"/>
      <definition
        value="Date, and optionally time, this program participation information is asserted as 'true'."/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.effectiveTime"/>
      </mapping>
    </element>
    <element id="Observation.component">
      <path value="Observation.component"/>
      <slicing>
        <discriminator>
          <type value="pattern"/>
          <path value="code"/>
        </discriminator>
        <rules value="closed"/>
      </slicing>
      <min value="1"/>
      <constraint>
        <key value="inv-dh-obs-02"/>
        <severity value="error"/>
        <human value="The component shall at least have a value or a data absent reason"/>
        <expression value="value.exists() or dataAbsentReason.exists()"/>
        <source
          value="http://ns.electronichealth.net.au/fhir/StructureDefinition/dh-observation-programparticipation-1"
        />
      </constraint>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship"/>
      </mapping>
    </element>
    <element id="Observation.component:participationStatus">
      <path value="Observation.component"/>
      <sliceName value="participationStatus"/>
      <short value="Program participation status"/>
      <definition
        value="Represents the current state of an individual's participation in a program. This status is only representative at the time this observation is asserted and may also represent participation exception states including exclusion or ineligibility."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[part_status].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:participationStatus.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[part_status].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:participationStatus.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <binding>
        <strength value="extensible"/>
        <valueSet
          value="https://healthterminologies.gov.au/fhir/ValueSet/health-program-participation-status-1"
        />
      </binding>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[part_status].value"/>
      </mapping>
    </element>
    <element id="Observation.component:participationStatusPeriod">
      <path value="Observation.component"/>
      <sliceName value="participationStatusPeriod"/>
      <short value="Program participation status validity period"/>
      <definition
        value="The validity period for the program participation status. This may be a date where the status is meaningful when described by a point in time, e.g. date of death."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[part_status_period].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:participationStatusPeriod.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[part_status_period].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:participationStatusPeriod.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="DateTime"/>
        <code value="Period"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[part_status_period].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:suspensionFlag">
      <path value="Observation.component"/>
      <sliceName value="suspensionFlag"/>
      <short value="Suspension of program participation"/>
      <definition
        value="An indicator of whether a individual has suspended participation from a program. The value is 'true' when the individual has suspended participation."/>
      <comment
        value="When valued for a disease screening program this concept is equivalent to Australian Institute of Health and Welfare data element 568068 [Person—suspended participation from a disease screening program indicator](https://meteor.aihw.gov.au/content/index.phtml/itemId/568068) and data element 568073 [Person—suspended participation from a disease screening program indicator, yes/no code N](https://meteor.aihw.gov.au/content/index.phtml/itemId/568073)."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[suspension_flag].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:suspensionFlag.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[suspension_flag].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:suspensionFlag.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="boolean"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[suspension_flag].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:suspensionReason">
      <path value="Observation.component"/>
      <sliceName value="suspensionReason"/>
      <short value="Reason for suspension of program participation"/>
      <definition value="The reason why an individual has suspended participation in a program."/>
      <comment
        value="When valued for a disease screening program this concept is equivalent to Australian Institute of Health and Welfare data element 568096 [Person—reason for suspending disease screening participation](https://meteor.aihw.gov.au/content/index.phtml/itemId/568096) and data element 568098 [Person—reason for suspending disease screening participation, code N](https://meteor.aihw.gov.au/content/index.phtml/itemId/568098)."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[suspension_rsn].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:suspensionReason.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[suspension_rsn].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:suspensionReason.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <binding>
        <strength value="extensible"/>
        <valueSet
          value="https://healthterminologies.gov.au/fhir/ValueSet/reason-for-suspension-health-program-1"
        />
      </binding>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[suspension_rsn].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:suspensionPeriod">
      <path value="Observation.component"/>
      <sliceName value="suspensionPeriod"/>
      <short value="Suspension of program participation period"/>
      <definition
        value="The period an participation in a program will be suspended. The end date of the period may not be known or suspension may be ongoing until further notice."/>
      <comment
        value="When valued for a disease screening program this concept is equivalent to Australian Institute of Health and Welfare data element 576726 [Person—suspended participation from a disease screening program date](https://meteor.aihw.gov.au/content/index.phtml/itemId/576726) and data element 576728 [Person—suspended participation from a disease screening program date, DDMMYYYY](https://meteor.aihw.gov.au/content/index.phtml/itemId/576728)."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[suspension_period].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:suspensionPeriod.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[suspension_period].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:suspensionPeriod[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="Period"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[suspension_period].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:optedOffFlag">
      <path value="Observation.component"/>
      <sliceName value="optedOffFlag"/>
      <short value="Opted off of program participation"/>
      <definition
        value="An indicator of whether an individual opted off from a program. The value is 'true' when the individual has opted off the program and will not participate further."/>
      <comment
        value="When valued for a disease screening program this concept is equivalent to Australian Institute of Health and Welfare data element 568066 [Person—opted off from a disease screening program indicator](https://meteor.aihw.gov.au/content/index.phtml/itemId/568066) and data element 568070 [Person—opted off from a disease screening program indicator, yes/no code N](https://meteor.aihw.gov.au/content/index.phtml/itemId/568070)."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[opted_off_flag].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:optedOffFlag.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[opted_off_flag].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:optedOffFlag.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="boolean"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[opted_off_flag].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:optedOffReason">
      <path value="Observation.component"/>
      <sliceName value="optedOffReason"/>
      <short value="Reason for opting off of program participation"/>
      <definition value="The reason why an individual has opted off participating in a program."/>
      <comment
        value="When valued for a disease screening program this concept is equivalent to Australian Institute of Health and Welfare data element 568084 [Person—reason for opting off a disease screening program](https://meteor.aihw.gov.au/content/index.phtml/itemId/568066) and data element 732523 [Person—reason for opting off a disease screening program, code N](https://meteor.aihw.gov.au/content/index.phtml/itemId/732523)."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[opted_off_rsn].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:optedOffReason.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[opted_off_rsn].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:optedOffReason.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <binding>
        <strength value="extensible"/>
        <valueSet
          value="https://healthterminologies.gov.au/fhir/ValueSet/reason-for-opting-off-health-program-1"
        />
      </binding>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[opted_off_rsn].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:optedOffDate">
      <path value="Observation.component"/>
      <sliceName value="optedOffDate"/>
      <short value="Opting off of program participation date"/>
      <definition value="The date an individual opted off participating in a program."/>
      <comment
        value="When valued for a disease screening program this concept is equivalent to Australian Institute of Health and Welfare data element 576717 [Person—opted off from a disease screening program date](https://meteor.aihw.gov.au/content/index.phtml/itemId/576717) and data element 576720 [Person—opted off from a disease screening program date, DDMMYYYY](https://meteor.aihw.gov.au/content/index.phtml/itemId/576720)."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[opted_off_date].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:optedOffDate.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[opted_off_date].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:optedOffDate.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="dateTime"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[opted_off_date].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:lastAction">
      <path value="Observation.component"/>
      <sliceName value="lastAction"/>
      <short value="Last program participation action"/>
      <definition value="The last program participation action."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[last_action].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:lastAction.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[last_action].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:lastAction[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[last_action].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:lastActionDate">
      <path value="Observation.component"/>
      <sliceName value="lastActionDate"/>
      <short value="Last program participation action date"/>
      <definition value="The time or time period of the last program participation action."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[last_action_date].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:lastActionDate.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[last_action_date].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:lastActionDate.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="DateTime"/>
        <code value="Period"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[last_action_date].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:nextAction">
      <path value="Observation.component"/>
      <sliceName value="nextAction"/>
      <short value="Next program participation action"/>
      <definition value="The next action expected or scheduled as part of the program."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[next_action].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:nextAction.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[next_action].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:nextAction.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[next_action].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:nextActionDate">
      <path value="Observation.component"/>
      <sliceName value="nextActionDate"/>
      <short value="Next program participation action date"/>
      <definition value="The time or time period of the next program participation action."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[next_action_date].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:nextActionDate.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[next_action_date].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:nextActionDate.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="DateTime"/>
        <code value="Period"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[next_action_date].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:forecastStatus">
      <path value="Observation.component"/>
      <sliceName value="forecastStatus"/>
      <short value="Forecast status with reference to program pathway, e.g. overdue"/>
      <definition
        value="The value recorded as 'next screening action' for a national cancer screening program. This value represents the most clinically relevant state at the time of assertion of this observation for future program participation, e.g. overdue or eligible at 25, and may repeat exception states relevant to forecasting program participation."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[forecast_status].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:forecastStatus.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[forecast_status].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:forecastStatus.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[forecast_status].observation.value"/>
      </mapping>
    </element>
    <element id="Observation.component:forecastStatusPeriod">
      <path value="Observation.component"/>
      <sliceName value="forecastStatusPeriod"/>
      <short value="Period associated with forecast status"/>
      <definition value="The time or time period associated with 'next status'."/>
      <max value="1"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[forecast_status_period].observation"/>
      </mapping>
    </element>
    <element id="Observation.component:forecastStatusPeriod.code">
      <path value="Observation.component.code"/>
      <mapping>
      <identity value="CDA.observation-program_part"/>
        <map value="observation.entryRelationship[forecast_status_period].observation.code"/>
      </mapping>
    </element>
    <element id="Observation.component:forecastStatusPeriod.value[x]">
      <path value="Observation.component.value[x]"/>
      <type>
        <code value="DateTime"/>
        <code value="Period"/>
      </type>
    </element>
    <mapping>
    <identity value="CDA.observation-program_part"/>
      <map value="observation.entryRelationship[forecast_status_period].observation.value"/>
    </mapping>
  </differential>
</StructureDefinition>
